<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Mock Grow Checkout</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; margin:16px}
    .card{border:1px solid #ddd; border-radius:12px; padding:16px}
    .row{display:flex; gap:8px}
    input,button,select{font-size:16px; padding:10px; border-radius:10px; border:1px solid #ccc; width:100%}
    button{border:0; background:#111; color:#fff; cursor:pointer}
    .muted{opacity:.7; font-size:14px}
  </style>
</head>
<body>
  <div class="card">
    <h2>תשלום לקורס דיגיטלי (Mock)</h2>
    <p class="muted">זהו דף לדמו בלבד — אין סליקה אמיתית</p>
    <label>שם מלא <input id="fullName" required/></label><br/>
    <label>אימייל <input id="email" type="email" required/></label><br/>
    <div class="row">
      <label>מס׳ כרטיס <input id="cc" placeholder="4580 **** **** ****" /></label>
      <label>CVV <input id="cvv" /></label>
    </div>
    <div class="row">
      <label>תוצאה לדמו
        <select id="outcome">
          <option value="success">הצלחה</option>
          <option value="fail">כישלון</option>
          <option value="abandoned">נטישה</option>
        </select>
      </label>
      <label>סכום <input id="amount" value="249" /></label>
    </div>
    <button id="pay">שלם עכשיו</button>
  </div>

  <script>
    const parentOrigin = "*"; // לטסטים. בפרודקשן: שים כאן origin ספציפי

    document.getElementById('pay').onclick = () => {
      const payload = {
        source: 'mock-grow',
        type: document.getElementById('outcome').value, // success | fail | abandoned
        data: {
          amount: Number(document.getElementById('amount').value),
          email: document.getElementById('email').value,
          fullName: document.getElementById('fullName').value,
          transactionId: 'MOCK-' + Math.random().toString(36).slice(2, 10),
          // אפשר להוסיף עוד שדות שנוח לך
        }
      };

      // סימולציה קטנה של latency
      setTimeout(() => {
        window.parent.postMessage(payload, parentOrigin);
        // אם זה היה redirect ל-Thank You — כאן היינו עושים window.location = "...";
      }, 600);
    };

    // אופציונלי: שליחת "close" אם היוזר לוחץ ESC/Back
    window.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        window.parent.postMessage({ source:'mock-grow', type:'close' }, parentOrigin);
      }
    });
  </script>
</body>
</html>
